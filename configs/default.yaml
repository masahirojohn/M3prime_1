seed: 42
device: "cuda"
step_ms: 40

paths:
  in_dir: "in"
  out_dir: "out"
  transcript: "in/transcript.json"
  dlc_csv: "in/dlc_landmarks.csv"
  pose_timeline: "in/pose_timeline.json"
  train_samples: "in/train_samples.jsonl"

dlc_columns:
  # t_msは空でOK（frame+fps または timestamp から算出）
  t_ms: ""
  frame: "frame"
  fps: 25

  # 顔幅（両目の外側）
  flx: "eye_left_outer_x"
  fly: "eye_left_outer_y"
  frx: "eye_right_outer_x"
  fry: "eye_right_outer_y"

  # 唇（外側）
  ulx: "mouth_outer_upper_x"
  uly: "mouth_outer_upper_y"
  llx: "mouth_outer_lower_x"
  lly: "mouth_outer_lower_y"
  mlx: "mouth_outer_left_x"
  mly: "mouth_outer_left_y"
  mrx: "mouth_outer_right_x"
  mry: "mouth_outer_right_y"

  # 唇（内側）— 参考/補助として利用（ETL内部融合用）
  ilx: "mouth_inner_left_x"
  ily: "mouth_inner_left_y"
  irx: "mouth_inner_right_x"
  iry: "mouth_inner_right_y"
  iux: "mouth_inner_upper_x"
  iuy: "mouth_inner_upper_y"
  ilx2: "mouth_inner_lower_x"   # lower
  ily2: "mouth_inner_lower_y"

  # likelihood（任意）
  lk_ul: "mouth_outer_upper_likelihood"
  lk_ll: "mouth_outer_lower_likelihood"
  lk_ml: "mouth_outer_left_likelihood"
  lk_mr: "mouth_outer_right_likelihood"

likelihood_threshold: 0.2  # ← まずは 0.2 が安定。0.1〜0.25で微調整

# ↓ Cell6の結果で上書き（以下は仮）
tau: [0.02, 0.05, 0.10]
rho: [0.20, 0.30, 0.40]
median_k: 5
hys_low_keep: 1
hys_high_keep: 1

train:
  batch_size: 32
  epochs: 12
  lr: 0.002
  weight_decay: 0.0001
  label_smoothing: 0.05
  early_stop_patience: 5

model:
  emb_dim: 128
  n_layers: 2
  n_heads: 4
  ffn_dim: 256
  dropout: 0.1

gate:
  f1_macro_min: 0.82
  timing_mae_ms_max: 80
  switch_per_sec_max: 6.0
